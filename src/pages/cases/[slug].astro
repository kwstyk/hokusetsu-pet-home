---
// src/pages/cases/[slug].astro
import BaseLayout from '../../layouts/BaseLayout.astro';
import { SITE } from '../../config/site';
import { getAllCases, getCaseBySlug, type Case } from '../../data/cases';

export function getStaticPaths() {
  const cases = getAllCases();
  return cases.map((item) => ({
    params: { slug: item.slug },
  }));
}

interface Props {
  caseItem: Case;
}

const { slug } = Astro.params;
const caseItem = getCaseBySlug(slug);

if (!caseItem) {
  throw new Error(`Case not found for slug: ${slug}`);
}

const pageTitle = `${caseItem.title}｜成約事例｜${SITE.name}`;
---

<BaseLayout title={pageTitle}>
  <main class="mx-auto max-w-5xl px-4 py-10 sm:px-6 lg:px-8 space-y-8 text-sm text-slate-700">
    {/* タイトル＋メタ */}
    <section class="space-y-3">
      <p class="text-xs text-slate-500">成約事例・サポート事例</p>
      <h1 class="text-2xl md:text-3xl font-bold text-slate-900">
        {caseItem.title}
      </h1>

      <div class="flex flex-wrap gap-2 text-[11px]">
        <span class="rounded-full bg-slate-100 px-2 py-0.5 text-slate-700">
          {caseItem.city}
        </span>
        <span class="rounded-full bg-slate-100 px-2 py-0.5 text-slate-700">
          {caseItem.dealType === 'rent' ? '賃貸' : '購入'}
        </span>
        <span class="rounded-full bg-slate-100 px-2 py-0.5 text-slate-700">
          {caseItem.petSummary}
        </span>
        <span class="rounded-full bg-slate-100 px-2 py-0.5 text-slate-700">
          {caseItem.familyType}
        </span>
      </div>

      <p class="leading-relaxed">
        {caseItem.summary}
      </p>
    </section>

    {/* Before / After 的な構成だけ作っておく */}
    <section class="grid gap-6 md:grid-cols-2">
      <div class="space-y-2">
        <h2 class="text-base font-semibold text-slate-900">
          ご相談時の状況・悩み
        </h2>
        <div class="rounded-xl bg-slate-50 p-4 space-y-2">
          <p class="text-xs font-semibold text-slate-800">
            主に悩んでいたこと
          </p>
          <p class="text-sm leading-relaxed">
            {caseItem.mainConcern}
          </p>
          <p class="text-xs text-slate-500">
            ※ 実際のご相談内容をもとに、個人が特定されない範囲で再構成した内容です。
          </p>
        </div>
      </div>

      <div class="space-y-2">
        <h2 class="text-base font-semibold text-slate-900">
          最終的にどうなったか
        </h2>
        <div class="rounded-xl bg-emerald-50 p-4 space-y-2">
          <p class="text-xs font-semibold text-emerald-900">
            決定した住まい・暮らし方のイメージ
          </p>
          <p class="text-sm leading-relaxed">
            {caseItem.resultSummary}
          </p>
          <p class="text-xs text-emerald-900">
            詳細な間取りや家賃などは、個人が特定されない範囲でのみ記載します。
          </p>
        </div>
      </div>
    </section>

    {/* 今後、本文を肉付けするためのスペース */}
    <section class="space-y-2">
      <h2 class="text-base font-semibold text-slate-900">
        今後の掲載イメージ（メモ）
      </h2>
      <p class="leading-relaxed">
        現時点では枠組みのみのため、本文はダミーです。
        実際の運用開始後は、
        <span class="font-semibold">「どんな条件をどう整理したか」「どこで折り合いをつけたか」</span>
        を文章で記載していく想定です。
      </p>
      <ul class="list-disc pl-5 space-y-1 text-xs text-slate-600">
        <li>最初に共有してもらった条件と、現実とのギャップ</li>
        <li>譲れない条件／譲ってもよい条件の整理</li>
        <li>候補物件の比較ポイント（ペット目線＋人間目線）</li>
        <li>最終的な決め手になったポイント</li>
      </ul>
    </section>

    {/* 戻る導線 */}
    <section>
      <a
        href="/cases/"
        class="inline-flex items-center text-xs font-semibold text-emerald-700 hover:underline"
      >
        ← 成約事例一覧に戻る
      </a>
    </section>
  </main>
</BaseLayout>
